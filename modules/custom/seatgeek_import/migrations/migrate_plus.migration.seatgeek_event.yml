# Migration configuration for performances.
id: seatgeek_event
label: Event migration
migration_group: seatgeek
source:  
  plugin: seatgeek_event
  data_fetcher_plugin: http
  data_parser_plugin: seatgeek_xml
  # gets overridden by config
  urls: https://tickets.ticket.com 
  item_selector: /feed/Show
  fields:
    -
      name: event_id
      label: Event ID
      selector: ID    
    -
      name: event_title
      label: Title
      selector: Name
    -
      name: event_date_from
      label: Event date from
      selector: events/Event[1]/ActualEventDate
    -
      name: event_date_to
      label: Event date to
      selector: events/Event[last()]/ActualEventDate
    -
      name: event_image
      label: Thumbnail
      selector: ImageUrl
    -
      name: Attributes
      label: Attributes
      selector: ShowExtraProperties     
#    - 
#      name: price
#      label: Pseudo element for price      
    - 
      name: venue
      label: Venue
      selector: events/Event[last()]/HallName
#    - 
#      name: genre
#      label: Genre
#      selector: ShowGenres
  ids:
    event_id:
      type: int
destination:
  plugin: entity:node
process:  
  type:
    plugin: default_value
    default_value: event
  title: event_title  
  field_venue: 
    plugin: entity_lookup
    bundle: venue
    source: venue
#  field_genre: genre
  field_seatgeek_event_id: event_id
  field_run_date:
    plugin: seatgeek_date_range
    source: 
      - event_date_from
      - event_date_to    
  sticky:
    plugin: default_value
    default_value: 0
#  'body/value': description
dependencies:
  module:
    - seatgeek_import
  enforced:
    module:
      - migrate_plus
      - seatgeek_import
